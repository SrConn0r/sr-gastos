import{r as h,m as A,j as e}from"./app-64DMMMvv.js";import{I as n}from"./InputError-Avpn8YL3.js";import{e as z,z as S,L as u,I as v,S as C,g as L,h as k,i as T,l as F,a4 as V,j as G,a5 as P,a6 as q,B as p,a7 as x,f as B,a8 as R,a9 as $,A as c}from"./popover-CKA4uPLf.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],J=z("Calendar",H);function W({categories:f,onClose:i,expense:a}){const[_,m]=h.useState(a?S(String(a.amount)).formatted:""),[w,g]=h.useState(a!=null&&a.category.id?String(a.category.id):""),E=()=>{if(a!=null&&a.expense_date){let t=String(a.expense_date);t.includes("T")&&(t=t.split("T")[0]);const[r,l,M]=t.split("-").map(Number);return new Date(r,l-1,M,12,0,0)}return new Date},{data:o,setData:s,errors:d,post:b,put:I,reset:y,processing:j}=A({title:(a==null?void 0:a.title)||"",category_id:(a==null?void 0:a.category.id)||void 0,amount:(a==null?void 0:a.amount)||void 0,expense_date:E()}),N=new Date,D=t=>{t.preventDefault();try{const r=x(o.expense_date,"yyyy-MM-dd");s("expense_date",r),a?I(route("expense.update",a.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(),m(""),g(""),s("category_id",void 0),c.success("Gasto actualizado exitosamente"),i==null||i()},onError:l=>{console.error("Error al actualizar el gasto",l),c.error("Error al actualizar el gasto")}}):b(route("expense.public-store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(),m(""),g(""),s("category_id",void 0),c.success("Gasto guardado exitosamente"),i==null||i()},onError:l=>{console.error("Error al guardar el gasto",l),c.error("Error al guardar el gasto")}})}catch(r){console.error("Error submitting form:",r),c.error("Error al procesar el formulario. Verifique los datos ingresados.")}};return h.useEffect(()=>{const t=r=>{document.querySelector('[role="dialog"]')||r.preventDefault()};return window.addEventListener("scroll",t,{passive:!1}),()=>window.removeEventListener("scroll",t)},[]),e.jsxs("form",{className:"w-full space-y-6",onSubmit:D,children:[e.jsxs("div",{children:[e.jsx(u,{children:"Titulo"}),e.jsx(v,{value:o.title,placeholder:"Ingrese el titulo",onChange:t=>s("title",t.target.value)}),e.jsx(n,{message:d.title})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Categoria"}),e.jsxs(C,{value:w,onValueChange:t=>{g(t),s("category_id",Number(t))},children:[e.jsx(L,{className:"w-full",children:e.jsx(k,{placeholder:"Seleccionar Categoria"})}),e.jsx(T,{className:"w-full",children:e.jsxs(F,{children:[e.jsx(V,{children:"Categoria"}),f.length>0&&f.map(t=>e.jsx(G,{value:String(t.id),children:t.name},t.id))]})})]}),e.jsx(n,{message:d.category_id})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Valor"}),e.jsx(v,{type:"text",placeholder:"Ingrese el monto",value:_,onChange:t=>{const{formatted:r,raw:l}=S(t.target.value);m(r),s("amount",l)}}),e.jsx(n,{message:d.amount})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Fecha"}),e.jsxs(P,{children:[e.jsx(q,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:B("w-full pl-3 text-left font-normal",!o.expense_date&&"text-muted-foreground"),children:[o.expense_date?x(o.expense_date,"dd/MM/yyyy"):e.jsx("span",{children:"Seleccionar fecha"}),e.jsx(J,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(R,{className:"w-auto p-0",align:"start",children:e.jsx($,{mode:"single",selected:o.expense_date,onSelect:t=>{t&&s("expense_date",t)},disabled:t=>t>N||t<new Date("1900-01-01"),defaultMonth:o.expense_date,initialFocus:!0})})]}),e.jsx(n,{message:d.expense_date})]}),e.jsx(p,{disabled:j,className:"w-full sm:w-auto",children:j?a?"Actualizando...":"Agregando...":a?"Actualizar gasto":"Agregar gasto"})]})}export{W as E};
