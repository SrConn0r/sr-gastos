import{r as h,m as A,j as e}from"./app-BS_vuow0.js";import{I as n}from"./InputError-BGzkQD94.js";import{e as z,z as S,L as u,I as v,S as C,g as L,h as k,i as F,l as T,F as G,j as P,P as V,G as q,B as p,H as x,f as B,J as H,K as J,A as c}from"./popover-BHfAPdNE.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],R=z("Calendar",K);function W({categories:f,onClose:i,expense:r}){const[_,m]=h.useState(r?S(String(r.amount)).formatted:""),[w,g]=h.useState(r!=null&&r.category.id?String(r.category.id):""),E=()=>{if(r!=null&&r.expense_date){let t=String(r.expense_date);t.includes("T")&&(t=t.split("T")[0]);const[a,l,M]=t.split("-").map(Number);return new Date(a,l-1,M,12,0,0)}return new Date},{data:o,setData:s,errors:d,post:b,put:I,reset:y,processing:j}=A({title:(r==null?void 0:r.title)||"",category_id:(r==null?void 0:r.category.id)||void 0,amount:(r==null?void 0:r.amount)||void 0,expense_date:E()}),N=new Date,D=t=>{t.preventDefault();try{const a=x(o.expense_date,"yyyy-MM-dd");s("expense_date",a),r?I(route("expense.update",r.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(),m(""),g(""),s("category_id",void 0),c.success("Gasto actualizado exitosamente"),i==null||i()},onError:l=>{console.error("Error al actualizar el gasto",l),c.error("Error al actualizar el gasto")}}):b(route("expense.public-store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(),m(""),g(""),s("category_id",void 0),c.success("Gasto guardado exitosamente"),i==null||i()},onError:l=>{console.error("Error al guardar el gasto",l),c.error("Error al guardar el gasto")}})}catch(a){console.error("Error submitting form:",a),c.error("Error al procesar el formulario. Verifique los datos ingresados.")}};return h.useEffect(()=>{const t=a=>{document.querySelector('[role="dialog"]')||a.preventDefault()};return window.addEventListener("scroll",t,{passive:!1}),()=>window.removeEventListener("scroll",t)},[]),e.jsxs("form",{className:"w-full space-y-6",onSubmit:D,children:[e.jsxs("div",{children:[e.jsx(u,{children:"Titulo"}),e.jsx(v,{value:o.title,placeholder:"Ingrese el titulo",onChange:t=>s("title",t.target.value)}),e.jsx(n,{message:d.title})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Categoria"}),e.jsxs(C,{value:w,onValueChange:t=>{g(t),s("category_id",Number(t))},children:[e.jsx(L,{className:"w-full",children:e.jsx(k,{placeholder:"Seleccionar Categoria"})}),e.jsx(F,{className:"w-full",children:e.jsxs(T,{children:[e.jsx(G,{children:"Categoria"}),f.length>0&&f.map(t=>e.jsx(P,{value:String(t.id),children:t.name},t.id))]})})]}),e.jsx(n,{message:d.category_id})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Valor"}),e.jsx(v,{type:"text",placeholder:"Ingrese el monto",value:_,onChange:t=>{const{formatted:a,raw:l}=S(t.target.value);m(a),s("amount",l)}}),e.jsx(n,{message:d.amount})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Fecha"}),e.jsxs(V,{children:[e.jsx(q,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:B("w-full pl-3 text-left font-normal",!o.expense_date&&"text-muted-foreground"),children:[o.expense_date?x(o.expense_date,"dd/MM/yyyy"):e.jsx("span",{children:"Seleccionar fecha"}),e.jsx(R,{className:"ml-auto h-4 w-4 opacity-50"})]})}),e.jsx(H,{className:"w-auto p-0",align:"start",children:e.jsx(J,{mode:"single",selected:o.expense_date,onSelect:t=>{t&&s("expense_date",t)},disabled:t=>t>N||t<new Date("1900-01-01"),defaultMonth:o.expense_date,initialFocus:!0})})]}),e.jsx(n,{message:d.expense_date})]}),e.jsx(p,{disabled:j,className:"w-full sm:w-auto",children:j?r?"Actualizando...":"Agregando...":r?"Actualizar gasto":"Agregar gasto"})]})}export{W as E};
